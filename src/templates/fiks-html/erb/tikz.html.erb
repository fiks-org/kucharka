<%# tikz picture nevironment %>
<%# filename: required name of the file %>
<% builder.register_job({
  output_file: meta['filename'] + '.svg',
  source_file: meta['filename'] + '.tex',
  command: meta['command'] || "pdflatex -halt-on-error -interaction nonstopmode #{meta['filename']} && pdf2svg #{meta['filename'] + '.pdf'} #{meta['filename'] + '.svg'}",
  source: <<DOC
\\documentclass[12pt]{standalone}
\\usepackage[utf8]{inputenc}
\\usepackage[T1]{fontenc}
\\usepackage[czech]{babel}
\\usepackage{libertine}
\\usepackage{amsmath}
\\usepackage{amssymb}
\\usepackage{tikz}
\\usepackage{ifthen}
\\usepackage{pgfplots}
\\usepackage{bbding}
\\newcommand{\\N}{\\mathbb{N}}
\\newcommand{\\Z}{\\mathbb{Z}}
\\newcommand{\\Q}{\\mathbb{Q}}
\\newcommand{\\R}{\\mathbb{R}}
\\newcommand{\\eR}{\\overline{\\R}}
\\newcommand{\\CC}{\\mathbb{C}}
\\newcommand{\\ee}{\\mathrm{e}}
\\newcommand{\\ii}{\\mathrm{i}}
\\renewcommand{\\Re}{\\mathrm{Re}\\,}
\\renewcommand{\\Im}{\\mathrm{Im}\\,}
\\DeclareMathOperator{\\tg}{tg}
\\DeclareMathOperator{\\ctg}{cotg}
\\DeclareMathOperator{\\cotg}{cotg}
\\DeclareMathOperator{\\arctg}{arctg}
\\DeclareMathOperator{\\arcctg}{arccotg}
\\DeclareMathOperator{\\tr}{tr}
\\newcommand{\\ceq}{\\mathrel{\\mathop:}=}
\\newcommand{\\veps}{\\varepsilon}
\\DeclareMathOperator{\\sgn}{\\mathrm{sgn}}
\\newcommand{\\dx}{\\mathrm{d}x}
\\newcommand{\\dt}{\\mathrm{d}t}

% Landau
\\newcommand{\\lano}{o}
\\newcommand{\\lanO}{\\mathcal{O}}

% matrices and vectors
\\newcommand{\\mA}{\\mathbf{A}}
\\newcommand{\\mB}{\\mathbf{B}}
\\newcommand{\\mC}{\\mathbf{C}}
\\newcommand{\\mD}{\\mathbf{D}}
\\newcommand{\\mE}{\\mathbf{E}}
\\newcommand{\\mP}{\\mathbf{P}}
\\newcommand{\\mQ}{\\mathbf{Q}}
\\newcommand{\\mX}{\\mathbf{X}}
\\newcommand{\\mI}{\\mathbf{I}}
\\newcommand{\\mF}{\\mathbf{F}}
\\newcommand{\\mG}{\\mathbf{G}}
\\newcommand{\\mR}{\\mathbf{R}}
\\newcommand{\\mS}{\\mathbf{S}}
\\newcommand{\\mSigma}{\\boldsymbol{\\Sigma}}
\\newcommand{\\mU}{\\mathbf{U}}
\\newcommand{\\mV}{\\mathbf{V}}
\\newcommand{\\mL}{\\mathbf{L}}
\\newcommand{\\mY}{\\mathbf{Y}}
\\newcommand{\\vx}{\\mathbf{x}}
\\newcommand{\\vy}{\\mathbf{y}}
\\newcommand{\\vz}{\\mathbf{z}}
\\newcommand{\\va}{\\mathbf{a}}
\\newcommand{\\vb}{\\mathbf{b}}
\\newcommand{\\vc}{\\mathbf{c}}
\\newcommand{\\ve}{\\mathbf{e}}
\\newcommand{\\vq}{\\mathbf{q}}
\\newcommand{\\vell}{\\boldsymbol{\\ell}}
\\newcommand{\\vu}{\\mathbf{u}}
\\newcommand{\\vv}{\\mathbf{v}}
\\newcommand{\\vw}{\\mathbf{w}}
\\newcommand{\\XX}{\\mathcal{X}}
\\newcommand{\\YY}{\\mathcal{Y}}
\\newcommand{\\EE}{\\mathcal{E}}
\\newcommand{\\PP}{\\mathcal{P}}
\\newcommand{\\UU}{\\mathcal{U}}
\\newcommand{\\ssubset}{\\subset\\subset}

% matrices with vertical lines
\\newcommand{\\pmat}[2]{\\left(\\!\\!\\begin{array}{#1}#2\\end{array}\\!\\!\\right)}

% logic
\\newcommand{\\logi}{{\\mkern4mu\\rule{0.4pt}{1.5ex}\\mkern-1mu\\raisebox{1pt}{$=$}\\mkern-1mu\\rule{0.4pt}{1.5ex}\\mkern3mu}}
\\newcommand{\\thus}{{\\mkern4mu\\rule{0.4pt}{1.5ex}\\mkern-1mu\\raisebox{1pt}{$=$}\\mkern2mu}}

% other
\\DeclareMathOperator{\\fl}{f \\kern 0.04em l}
\\DeclareMathOperator{\\lcm}{lcm}

% colors
\\newcommand{\\clr}[2]{{\\color{#1}#2}}

\\usetikzlibrary{
  shapes.geometric,
  calc,
  arrows,
  decorations.markings,
  decorations.pathmorphing
}
\\pgfplotsset{
  % all plots are thick and without point marks
  every axis plot/.append style={
    thick,
    mark=none,
    smooth
  },
  % axis style
  every axis/.append style={
    axis lines=middle,
    axis line style={->,thick},
    grid=major,
    minor tick num=1,
    tick label style={font=\\footnotesize,fill=white,opacity=0.5,text opacity=1.0}
  },
  % grid style
  every axis grid/.style={
    thin,
    gray,
    dashed
  },
  % legend style
  every axis legend/.append style={
    at={(1.1,0.5)},
    anchor=west,
    %legend pos=outer east,
    %legend columns=2,
    cells={anchor=west},
    font=\\footnotesize,
    rounded corners=2pt
  },
  xlabel={$x$},ylabel={$y$}
}
\\begin{document}
\\begin{tikzpicture}[#{ meta['options'] || '' }]
#{ strip_indent(dump).strip }
\\end{tikzpicture}
\\end{document}

DOC

})
%>
<img class="woowoo-tikz figure-img img-fluid" src="<%= File.join(builder.figures_dir, meta['filename'] + '.svg') %>" alt="<%= meta['alt']%>"></img>
